# vk
Основной класс для создания бота. Доступен с версии `0.8`.

## Конструктор
| Параметр       | Тип   | Описание                                                                               |
|----------------|-------|----------------------------------------------------------------------------------------|
| $auth_data     | array | [Данные для авторизации](#авторизация)                                                 |
| $needLowerCase | bool  | Использовать функцию `mb_strtolower` при обработке команд или нет. По умолчанию `true` |

```php
$vk = new vk([
  'token' => 'qwerty12345',
  'type' => 'lp'
]);
```

### Авторизация
С версии `0.9` был введен новый способ авторизации. Теперь вам не нужно создавать файл конфигурации для того, чтобы запустить бота.

Есть два варианта авторизации:
* по логину и паролю. **Не поддерживается 2FA, но поддерживается** `trusted_hash`
* по токену. Этот тип авторизации имеет больший приоритет

Для начала рассмотрим общие для обоих методов параметры.

|
|
| type | string | Тип получения данных: `lp` или `cb` (только для сообществ). Всегда обязательный |
| secret | string | Секретный ключ. Если не указан или является пустой строкой, этот параметр не проверяется |
| v | string | Версия API. Минимальная `5.0`, по умолчанию `5.118` |

**Авторизация по логину и паролю.** Описание параметров:

| Параметр     | Тип    | Обязательный? | Описание                                                             |
|--------------|--------|---------------|----------------------------------------------------------------------|
| username     | string | +             | Логин пользователя                                                   |
| password     | string | +             | Пароль пользователя                                                  |
| trusted_hash | string | -             | Описание этого параметра можно найти [здесь](../auth/trustedhash.md) |

```php
$vk = new vk([
	'username' => 'me@slmatthew.dev',
	'password' => 'pleaseDonateMe12345',
	'type' => 'lp'
]);
```

**Авторизация по токену.** Этот тип авторизации требует от вас только `access_token`, тип владельца и его ID библиотека определит самостоятельно.

```php
$vk = new vk([
	'token' => 'x6pstvcdeyp5y8c82gthdgc22h7za5aq5pf6cf7su3yf3ur2eassz8uxuxk6q2aacy5m6e5e3kq5eybw3upsk',
	'type' => 'lp'
]);
```

## newBot
Метод для создания экземпляра класса [BotEngine](botengine.md). Этот метод вызывается в конструкторе, но может использоваться для пересоздания.

Возвращает `$this->bot`, содержащее экземпляр класса [BotEngine](botengine.md).

| Параметр       | Тип    | Описание                                                                               |
|----------------|--------|----------------------------------------------------------------------------------------|
| $needLowerCase | bool   | Использовать функцию `mb_strtolower` при обработке команд или нет. По умолчанию `true` |

```php
$vk->newBot();
```

## setConfirmation
Задать строку для подтверждения Callback API сервера.

```php
$vk->setConfirmation('1234abcd');
```

## listen
Начать слушать события. Возвращает `$this->client`, содержащее экземпляр класса [DataHandler](datahandler.md).

## Поля класса
### bot
Экземпляр класса [BotEngine](botengine.md) или `null`.

### client
Экземпляр класса [DataHandler](datahandler.md) или `null`.

### audio
Экземпляр класса [VkAudio](audio.md) (если используется токен пользователя) или `null`.